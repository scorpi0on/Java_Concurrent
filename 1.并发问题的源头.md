# 1.并发问题的源头

## 本质

CPU，内存 与 I/O设备的速度差异巨大，系统平衡差异通过：

1. 增加cpu缓存

   - 多核cpu缓存独立

2. 操作系统增加进程，线程

   - 高级语言count += 1在cpu执行上并非具有原子性

3. 编译优化指令执行次序

   - 双重检查创建单例对象 

     > 对于双重锁的问题：
     >
     > 线程A进入第二个判空条件，进行初始化时，发生了时间片切换，即使没有释放锁，线程B刚要进入第一个判空条件时，发现条件不成立，直接返回instance引用，不用去获取锁。如果对instance进行volatile语义声明，就可以禁止指令重排序，避免该情况发生。

## 总结

1. 缓存导致变量可见性问题

2. 线程切换导致原子性问题

3. 编译优化导致有序性问题